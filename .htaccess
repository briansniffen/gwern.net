# Add caching/expire headers for performance
FileETag MTime
<ifModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 2 days"
  ExpiresByType text/css "access plus 40 days"
  ExpiresByType text/javascript "access plus 60 days"
  ExpiresByType application/javascript "access plus 60 days"
  ## expire images after a month or so
  ExpiresByType image/png A3592000
  ExpiresByType image/jpg A3592000
  ExpiresByType image/svg A3592000
  ExpiresByType image/vnd.microsoft.icon A7592000
  ## the PDFs are likewise usually unchanging
  ExpiresByType application/pdf A4592000
</ifModule>

# Add static gzip'd support, again, for performance
## http://www.hunlock.com/blogs/Compressed_HTML_makes_your_pages_zippy
## https://members.nearlyfreespeech.net/forums/viewtopic.php?p=21798#21798
Options +MultiViews
AddEncoding x-gzip .gz
RewriteEngine on
RewriteOptions Inherit
## Check to see if browser can accept gzip files.
ReWriteCond %{HTTP:accept-encoding} (gzip.*)
## make sure there's no trailing .gz on the url
ReWriteCond %{REQUEST_FILENAME} !^.+\.gz$
## check to see if a .gz version of the file exists.
RewriteCond %{REQUEST_FILENAME}.gz -f
## All conditions met so add .gz to URL filename (invisibly)
RewriteRule ^(.+) $1.gz [L]

# redirect URLs that people commonly misspell
## Article targets for moving:
### "Copyright" ~> "Incoherence of Copyright" (?)
### "Culture is not about esthetics" ~> "Culture is not about Esthetics"
### "N-back FAQ" ~> "DNB FAQ"
### "WP RSS bot" ~> "Wikipedia RSS Bot"
### "WP redirect generator" ~> "Wikipedia Redirect Generator"
### "Wikipedia and Dark side editing" ~> "Wikipedia and Dark Side Editing"
### "Wikipedia and Other Wikis" ~> "Wikipedia and other Wikis"
Redirect 301 "/haskell summer of code.html" "http://www.gwern.net/Haskell Summer of Code.html"
Redirect 301 "/melatonin.html"              "http://www.gwern.net/Melatonin.html"
Redirect 301 "/mnemosyne.html"              "http://www.gwern.net/Mnemosyne.html"
Redirect 301 "/modafinil.html"              "http://www.gwern.net/Modafinil.html"
Redirect 301 "/n-back faq.html"             "http://www.gwern.net/N-back FAQ.html"
Redirect 301 "/nootropics.html"             "http://www.gwern.net/Nootropics.html"
Redirect 301 "/haskell/Archiving%20GitHub.html" "http://www.gwern.net/haskell/Archiving GitHub.html"